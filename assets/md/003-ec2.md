# (EC2) Elastic Compute Cloud
![](../uml/003-ec2/ec2-intro.svg)

- **Rent Virtual Machines:** EC2 allows users to rent
  virtual machines, known as instances, tailored to specific requirements
  such as compute power, memory, and storage.
- **Storing Data:** storage options include Elastic Block Store (EBS) for
  virtual drives and Elastic File System (EFS) for network-attached
  storage. EC2 instances can also leverage Instance Store, offering
  ephemeral storage directly attached to the host machine.
  <br/>
  <br/>
  ![](../uml/003-ec2/ec2-storage.svg)
- **Distributing WorkLoad:** Elastic Load Balancer (ELB) facilitates the
  distribution of incoming application traffic across multiple EC2
  instances.
- **Scaling Services:** Auto Scaling Groups (ASG) enable automatic scaling of
  EC2 instances based on predefined criteria. This ensures that
  applications can dynamically adapt to varying workloads, optimizing
  performance and cost efficiency.
  <br/>
  <br/>
  ![](../uml/003-ec2/ec2-load-balancer.svg)

## EC2 Sizing & configuration options
- **Operating System (OS):** Linux, Windows or MacOs
- **Compute Power & Cores (CPU):** level of compute
  power and the number of cores to meet application requirements.
- **Random-Access Memory (RAM):** Specify the amount of memory needed
  for optimal performance.
- **Storage Space:** Determine the storage type, including network-attached
  (EBS & EFS) and hardware (EC2 Instance Store) options.
- **Network Configuration:** Configure network-related settings, such as the
  speed of the network card, assignment of public IP addresses. 
- **Firewall rules** through security groups.
- **Bootstrap Script (EC2 User Data):** Use EC2 User Data to automate boot tasks as: 
  - Run scripts at the instance’s first start. This script, executed
    with ***root*** user privileges, can perform actions such as:
    - installing updates,
    - installing software
    - downloading files from the internet.
  - Anything you can think of

## EC2 InstanceTypes - Overview
When we see `m5.2xlarge`\
- ***m***: instance type
- ***5***: Generation (indicating AWS improvements over time)
- ***2xlarge***: Size within the instance class
<br/>
<br/>
![](../uml/003-ec2/ec2-instance-types.svg)

## CIDR — Classless Inter-Domain Routing
It is a method for efficiently allocating and managing IP addresses in computer networks.
It is crucial to define IP address ranges.
CIDR notation:
- **Base IP address**. Represents a specific IP address within the range. (Examples
  include 10.0.0.0, 192.168.0.0, and so forth.)
- **Subnet Mask**. Defines how many bits of the IP address cannot change, are fixed.

**Example**:
For instance, using the CIDR notation 192.168.0.0/26: This allows for 64 IP
addresses within the range 192.168.0.0 to 192.168.0.63.
The subnet mask /26 signifies that the first 26 bits are fixed, and the
remaining **6** bits can vary, providing $`2^6 = 64`$ possible combinations.

## Security Groups
![](../uml/003-ec2/ec2-security-group-1.svg)
- Security Group rules can be defined based on either **IP addresses** or **other
  Security Groups**.
- **Security groups only contain allow rules**
- By default, a security group includes an outbound rule that allows all outbound traffic.
 !!! Remove this default rule and add outbound rules that allow specific outbound traffic only !!!.
- All inbound traffic is blocked by default. By default there is NO inbound rules just after the Security Group is created.
- ***General features***:
  - Single Security Group can be attached to multiple instances.
  - Locked down to a region / VPC combination.
  - Security Groups operate independently of the EC2 instances. 
If traffic is blocked by a Security Group, the associated
    EC2 instance remains unaware of the attempted communication.
  - Maintain one separate security group for SSH access.
- ***Firewall Functionality***:
  - Access to specific ports
  - Authorization of IP ranges for both IPv4 and IPv6
  - Control over inbound network traffic
- Control over outbound network traffic
- ***Troubleshooting Tips***
  - Timeout Issues: in case an application becomes inaccessible and times
  out, it is likely attributed to a Security Group misconfiguration.
  - “Connection Refused” Errors: if an application returns a “connection
  refused” error, the problem may lie either with the application itself or its
  launch status rather than the Security Group settings.
- ***Sample***
  - *Security Group 1:* 
    - The 1st inbound rule <code style="color:green">198.51.100.0/24, TCP, 22</code> allows `ssh` traffic from specific IPs `[198.51.100.0 - 198.51.100.255]`  
    - The 2nd inbound rule <code style="color:#cc0066">Subnet A CIDR, All, All</code> allows the instances in **subnet A** to communicate with each other (of **subnet A**) using any protocol and port.
    - The 3rd outbound rule <code style="color:#0066ff">0.0.0.0/0, All, All</code> allows all outbound traffic from any instance in **subnet A**.
  - *Security Group 2:*
    - The 1st inbound rule <code style="color:orange">Subnet B CIDR, All, All</code> allows the instances in **subnet B** to communicate with each other (of **subnet B**) using any protocol and port.
    - The 2nd inbound rule <code style="color:red">Subnet A CIDR, TCP, 22</code> allows the instances in **subnet A** to communicate with the instances in **subnet B** using SSH.
    - The 3rd outbound rule <code style="color:#7F00FF">0.0.0.0/0, All, All</code> allows all outbound traffic from any instance in **subnet B**.

![](../uml/003-ec2/ec2-security-group-2.svg)

  
## EC2 Instances Purchasing Options